<!DOCTYPE html>
<html>
	<head>
		<meta charset="utf-8">
		<title>临钢优选</title>
		<link rel="stylesheet" type="text/css" href="font/css/font-awesome.min.css" />
		<link rel="stylesheet" type="text/css" href="css/idangerous.swiper.css" />
		<link rel="stylesheet" type="text/css" href="css/APlayer.min.css"/>
		<link rel="stylesheet" type="text/css" href="css/reset.css" />
		<link rel="stylesheet" type="text/css" href="css/head.css" />
		<link rel="stylesheet" type="text/css" href="css/footer.css" />
		<link rel="stylesheet" type="text/css" href="css/shop.css" />
		<style type="text/css">
			.shop-table tr:nth-of-type(odd) {
			    background: #f5f3f2;
			}
		</style>
	</head>
	<body style="background: #e5e5e5;">
		<!-- 顶部导航 -->
		<div class="headerpage"></div>
		<div class="shop-type-box">

			<div class="shop-mage">

				<div class="shop-mage-top">
					<form action="" method="post">
						<span class="searchTop-find" onclick="searchBtn()">搜索</span>
						<span class="searchTop-clear">清空</span>
						<div class="shop-type">
							<ul class="clearfix">
								<li><a class="searchAll active" href="#">全部</a></li>
								
							</ul>
						</div>
						<div class="search-top clearfix">
							<div class="searchTop-list secDq fl clearfix">
								<span class="search-tit">地区</span>
								<select>
									<option value ="">全部</option>
								</select>
							</div>
							<div class="searchTop-list secGc fl">
								<span class="search-tit">钢厂</span>
								<select>
									<option value ="">全部</option>
								</select>
							</div>
							<div class="searchTop-list secPm fl">
								<span class="search-tit">品名</span>
								<select>
									<option value ="">全部</option>
								</select>
							</div>
							<div class="searchTop-list secCk fl">
								<span class="search-tit">仓库</span>
								<select>
									<option value ="">全部</option>
								</select>
							</div>
						</div>
						<div class="searchMore secGg clearfix">
							<span class="searchMore-tit">规格</span>
							<span class="searchMore-tip"><i class="fa fa-plus" aria-hidden="true"></i><b>更多</b></span>
							<ul class="searchMore-mage searchMore-open clearfix">
								<li>0.45*1250*C</li>
								<li>0.47*1250*C</li>
								<li>0.47*1250*C</li>
								<li>0.47*1250*C</li>
								<li>0.47*1250*C</li>
								<li>0.47*1250*C</li>
								<li>0.47*1250*C</li>
								<li>0.47*1250*C</li>
								<li>0.47*1250*C</li>
								<li>0.47*1250*C</li>
								<li>0.47*1250*C</li>
								<li>0.47*1250*C</li>
								<li>0.47*1250*C</li>
								<li>0.47*1250*C</li>
								<li>0.47*1250*C</li>
								<li>0.47*1250*C</li>
								<li>0.47*1250*C</li>
								<li>0.47*1250*C</li>
								<li>0.47*1250*C</li>
								<li>0.47*1250*C</li>
								<li>0.47*1250*C</li>
								<li>0.47*1250*C</li>
								<li>0.47*1250*C</li>
								<li>0.47*1250*C</li>
								<li>0.47*1250*C</li>
								<li>0.47*1250*C</li>
								<li>0.47*1250*C</li>
								<li>0.47*1250*C</li>
							</ul>
						</div>
						<div class="searchMore secCz clearfix">
							<span class="searchMore-tit">材质</span>
							<span class="searchMore-tip"><i class="fa fa-plus" aria-hidden="true"></i><b>更多</b></span>
							<ul class="searchMore-mage searchMore-open clearfix">
								<li>SGCC</li>
								<li>Q235</li>
								<li>SGH400</li>
								<li>DX51D</li>
								<li>SGHC</li>
								<li>Q235</li>
								<li>SGH400</li>
								<li>DX51D</li>
							</ul>
						</div>
						<div class="search-btm clearfix">
							<div class="searchB-list fl clearfix">
								<span class="search-tit">厚度</span>
								<div class="searchB-two fl clearfix">
									<input type="text" name="" id="" value="" />
									<span class="fl">~</span>
									<input type="text" name="" id="" value="" />
								</div>
							</div>
							<div class="searchB-list fl clearfix">
								<span class="search-tit">宽度</span>
								<div class="searchB-two fl clearfix">
									<input type="text" name="" id="" value="" />
									<span class="fl">~</span>
									<input type="text" name="" id="" value="" />
								</div>
							</div>
							<div class="searchB-list fl clearfix">
								<span class="search-tit">长度</span>
								<div class="searchB-two fl clearfix">
									<input type="text" name="" id="" value="" />
									<span class="fl">~</span>
									<input type="text" name="" id="" value="" />
								</div>
							</div>
							<div class="searchB-list fl clearfix">
								<span class="search-tit">重量</span>
								<div class="searchB-two fl clearfix">
									<input type="text" name="" id="" value="" />
									<span class="fl">~</span>
									<input type="text" name="" id="" value="" />
								</div>
							</div>
							<div class="searchB-list fl clearfix">
								<span class="search-tit">价格</span>
								<div class="searchB-two fl clearfix">
									<input type="text" name="" id="" value="" />
									<span class="fl">~</span>
									<input type="text" name="" id="" value="" />
								</div>
							</div>
						</div>
					</form>
				</div>
				<div class="shop-table-box">
					<table class="shop-table">
						<thead>
							<tr>
								<th width="8%">钢厂</th>
								<th width="9%">品名</th>
								<th width="10%">材质</th>
								<th width="16%">规格</th>
								<th width="9%">仓库</th>
								<th width="8%">数量</th>
								<th width="8%">吨数</th>
								<th width="8%">单价</th>
								<th width="8%">备注</th>
								<th></th>
							</tr>
						</thead>
						<tbody>
							
						</tbody>
						
					</table>
				</div>
			</div>
			<ul class="shop-step clearfix">
				<li class="stepList">
					<span>
						<img src="img/footer/login.png">
					</span>
					<p>注册登录</p>
				</li>
				<img class="stepImg" src="img/footer/right.png">
				<li class="stepList">
					<span>
						<img src="img/footer/down.png">
					</span>
					<p>锁货下单</p>
				</li>
				<img class="stepImg" src="img/footer/right.png">
				<li class="stepList">
					<span>
						<img src="img/footer/sure.png">
					</span>
					<p>确认合同</p>
				</li>
				<img class="stepImg" src="img/footer/right.png">
				<li class="stepList">
					<span>
						<img src="img/footer/set.png">
					</span>
					<p>定制剪切</p>
				</li>
				<img class="stepImg" src="img/footer/right.png">
				<li class="stepList">
					<span>
						<img src="img/footer/send.png">
					</span>
					<p>物流配送</p>
				</li>
				<img class="stepImg" src="img/footer/right.png">
				<li class="stepList">
					<span>
						<img src="img/footer/sign.png">
					</span>
					<p>确认签收</p>
				</li>
				<img class="stepImg" src="img/footer/right.png">
				<li class="stepList">
					<span>
						<img src="img/footer/over.png">
					</span>
					<p>一票结算</p>
				</li>
			</ul>
		</div>
		<!-- 底部 -->
		<div class="footerpage"></div>

		<script src="js/jquery.min.js" type="text/javascript" charset="utf-8"></script>
		<script src="js/right.js" type="text/javascript" charset="utf-8"></script>
		<script src="js/tools.js" type="text/javascript" charset="utf-8"></script>
		<script type="text/javascript">
			function shopType(thiz){
				$(thiz).addClass('active').parent().siblings().find('a').removeClass('active');
			}
			$('.searchMore-mage li').click(function() {
				$(this).toggleClass('active');
			});
			$('.searchMore').each(function() {
				var smLength = $(this).find('.searchMore-mage li').length
				if (smLength < 9) {
					$(this).find('.searchMore-tip').hide();
				}
			});
			$('.searchMore-tip').click(function() {
				if ($(this).find('i').is('.fa-plus')) {
					$(this).parent('.searchMore').find('.searchMore-mage').css({
						'height': 'auto',
						'max-height': '114px',
						'overflow': 'auto'
					});
					$(this).find('i').removeClass('fa-plus').addClass('fa-chevron-up');
					$(this).find('b').html('收起');
				} else {
					$(this).parent('.searchMore').find('.searchMore-mage').css({
						'height': '28px',
						'overflow': 'hidden'
					});
					$(this).find('i').removeClass('fa-chevron-up').addClass('fa-plus');
					$(this).find('b').html('更多');
				}
			});
			
		</script>
		<script type="text/javascript">
			$('.secPm').change(function(){
				$('.shop-type').find('.active').removeClass('active');
			})
			// 清空
			$('.searchTop-clear').click(function() {
				$(this).parents('.shop-mage-top').find('.active').removeClass('active')
				$(this).parents('.shop-mage-top').find('input').val("");
				$(this).parents('.shop-mage-top').find('select').val("");
			})
		</script>
		<script>
			$(function() {
				/*公共部分
				 * 导航栏
				 * footer CopyRight
				 */
				$(".headerpage").load("header.html");
				$(".footerpage").load("footer.html");
			});
		</script>
		<script type="text/javascript">
			// 加载所有商品
			$(function(){
				$.ajax({
					url: path + '/linA/listsp',
					type:'GET',
					data:{},
					dataType:'json', //后台返回的数据类型是json文本
					success:function(result) {
						if(result != "" && result.code == 1){
							var spList = result.data;
							for(var i in spList){
								var spBox =
									'<tr><td style="text-align: center;">' +
									'<img src="'+ photoPath + spList[i].cLogo + '"class="td-align td-img">' + spList[i].cShopName + '</td>'+
									'<td>' + spList[i].cName + '<span class="hidden">'+ spList[i].cId + '</span></td>'+
									'<td>' + spList[i].cName + '</td>'+
									'<td>' + spList[i].cName + '</td>'+
									'<td>' + spList[i].cName + '</td>'+
									'<td>' + spList[i].cName + '</td>'+
									'<td>' + spList[i].cName + '</td>'+
									'<td>' + spList[i].cName + '</td>'+
									<!-- <td class="red">价格登录可见</td> -->
									'<td>' + spList[i].cName + '</td>'+
									'<td class="clearfix">'+
									'<span class="shop-plan" onclick="goShopCart(this,\''+ spList[i].cId + '\')"><i class="fa fa-cart-arrow-down" aria-hidden="true"></i> 加入购物车</span></td></tr>'

								$('.shop-table tbody').append(spBox);
							}
						}
					}
				})
			});
			
			// 筛选第一行
			$(function(){
				$.ajax({
					url: path + '/linA/listdh2',
					type:'GET',
					data:{
						id:15897038511562900
					},
					dataType:'json', //后台返回的数据类型是json文本
					success:function(result) {
						if(result != "" && result.code == 1){
							var spList = result.data;
							// console.log(result)
							for(var i in spList){
								var spListTop =
									'<span></span><li><a href="#" onclick="shopType(this)"><img src="'+ photoPath + spList[i].cLogo +'">'+ spList[i].cName +'</a></li>';
								$('.shop-type ul').append(spListTop);
							};
						}
					}
				})
			});
			// 选择地区/仓库
			$(function(){
				$.ajax({
					url: path + '/linA/listsf',
					type:'GET',
					data:{},
					dataType:'json', //后台返回的数据类型是json文本
					success:function(result) {
						if(result != "" && result.code == 1){
							var spList = result.data;
							// console.log(result)
							for(var i in spList){
								var spDq = '<option value="'+ spList[i].cName +'">'+ spList[i].cName +'</option>';
								var spCk = '<option value="'+ spList[i].cStoreName +'">'+ spList[i].cStoreName +'</option>';
								$('.secDq select').append(spDq);
								$('.secCk select').append(spCk);
							};
						}
					}
				})
			});
			// 选择钢厂
			$(function(){
				$.ajax({
					url: path + '/linA/listgc',
					type:'GET',
					data:{},
					dataType:'json', //后台返回的数据类型是json文本
					success:function(result) {
						if(result != "" && result.code == 1){
							var spList = result.data;
							// console.log(result)
							for(var i in spList){
								var spGc = '<option value="'+ spList[i].cShopName +'">'+ spList[i].cShopName +'</option>';
								$('.secGc select').append(spGc);
							};
						}
					}
				})
			});
			// 选择品名
			$(function(){
				$.ajax({
					url: path + '/linA/listpm',
					type:'GET',
					data:{
						id:15897038511562900
					},
					dataType:'json', //后台返回的数据类型是json文本
					success:function(result) {
						if(result != "" && result.code == 1){
							var spList = result.data;
							// console.log(result)
							for(var i in spList){
								var spPm = '<option value="'+ spList[i].cName +'">'+ spList[i].cName +'</option>';
								$('.secPm select').append(spPm);
							};
						}
					}
				})
			});
			// 搜索提交
			function searchBtn(){
				var upDq = $('.secDq  option:selected').val();
				var upGc = $('.secGC  option:selected').val();
				var upPm = $('.secPm  option:selected').val();
				var upCk = $('.secCk  option:selected').val();
				var upGg = $('.secGg .active');
				var upCz = $('.secCz .active');
				var setGg = '';
				var setCz = '';
				for(var i=0;i< upGg.length;i++){
					setGg += upGg.eq(i).html()+',';
				};
				for(var i=0;i< upCz.length;i++){
					setCz += upCz.eq(i).html()+',';
				};
				// console.log(upCk)
				$.ajax({
					url: path + '/linA/listsp',
					type:'GET',
					// beforeSend: function (XMLHttpRequest) {
					// 	XMLHttpRequest.setRequestHeader("token", tkn);
					// },
					data:{
						pId: upDq,
						shopName: upGc,
						sCTId: upPm,
						ck: upCk,
						gg: setGg,
						cz: setCz,
					},
					// contentType: 'application/json;charset=utf-8',
					dataType:'json', //后台返回的数据类型是json文本
					success:function(result) {
						if(result != "" && result.code == 1){
							$('.shop-table tbody').html('');
							var spList = result.data;
							for(var i in spList){
								var spBox =
									'<tr><td style="text-align: center;">' +
									'<img src="'+ photoPath + spList[i].cLogo + '"class="td-align td-img">' + spList[i].cShopName + '</td>'+
									'<td>' + spList[i].cName + '<span class="hidden">'+ spList[i].cId + '</span></td>'+
									'<td>' + spList[i].cName + '</td>'+
									'<td>' + spList[i].cName + '</td>'+
									'<td>' + spList[i].cName + '</td>'+
									'<td>' + spList[i].cName + '</td>'+
									'<td>' + spList[i].cName + '</td>'+
									'<td>' + spList[i].cName + '</td>'+
									<!-- <td class="red">价格登录可见</td> -->
									'<td>' + spList[i].cName + '</td>'+
									'<td class="clearfix">'+
									'<span class="shop-plan" onclick="goShopCart(this,\''+ spList[i].cId + '\')"><i class="fa fa-cart-arrow-down" aria-hidden="true"></i> 加入购物车</span></td></tr>'
				
								$('.shop-table tbody').append(spBox);
							}
						}
					}
				})
			};
			// 添加购物车
			function goShopCart(thiz,goodsId){
				var tkn = getCookie(tk);
				var json = JSON.stringify({
					pId:goodsId
				});
				$.ajax({
					url: path + '/linA/addgwc',
					type:'POST',
					beforeSend: function (XMLHttpRequest) {
						XMLHttpRequest.setRequestHeader("token", tkn);
					},
					data:json,
					contentType: 'application/json;charset=utf-8',
					dataType:'json', //后台返回的数据类型是json文本
					success:function(result){
						if(result != "" && result.code == 1){
							alert(result.msg)
							var cartNum = parseInt($('.cart-num').html());
							$('.cart-num').html(cartNum + 1)
						}else{
							alert(result.msg)
						}
					}
				})
			};
		</script>
	</body>
</html>
